(*
Lift of double.atrs to ticking monad; ad-hoc way.

double f x = f (f x);
add x 0 = x;
add x (S y) = S (add x y);
main x = double (add x);
*)

addT t1 Z = t1;
addT t1 (T t2) = T (addT t1 t2);

succm (x, t) = (S x, t);
tick (a, t) = (a, T t);

addm (x,t1) (0,t2) = (x, T (addT t1 t2));
addm (x,t1) (S y, t2) = tick (succm (addm (x,t1) (y, t2)));

doublem fm (x,t) = fm (fm (x, t));
main x y = tick (doublem (addm (x,Z)) (y,Z));
